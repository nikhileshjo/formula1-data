date_dim|SELECT * FROM (SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session1DateUtc) AS BIGINT) AS date_id, Session1DateUtc AS full_timestamp, Session1Date AS local_timestamp, TRIM(DATE_FORMAT(Session1DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session1DateUtc, 'MMMM')) AS month_name, YEAR(Session1DateUtc) AS year, QUARTER(Session1DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL  UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session2DateUtc) AS BIGINT) AS date_id, Session2DateUtc AS full_timestamp, Session2Date AS local_timestamp, TRIM(DATE_FORMAT(Session2DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session2DateUtc, 'MMMM')) AS month_name, YEAR(Session2DateUtc) AS year, QUARTER(Session2DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL  UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session3DateUtc) AS BIGINT) AS date_id, Session3DateUtc AS full_timestamp, Session3Date AS local_timestamp, TRIM(DATE_FORMAT(Session3DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session3DateUtc, 'MMMM')) AS month_name, YEAR(Session3DateUtc) AS year, QUARTER(Session3DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL  UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session4DateUtc) AS BIGINT) AS date_id, Session4DateUtc AS full_timestamp, Session4Date AS local_timestamp, TRIM(DATE_FORMAT(Session4DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session4DateUtc, 'MMMM')) AS month_name, YEAR(Session4DateUtc) AS year, QUARTER(Session4DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL  UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session5DateUtc) AS BIGINT) AS date_id, Session5DateUtc AS full_timestamp, Session5Date AS local_timestamp, TRIM(DATE_FORMAT(Session5DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session5DateUtc, 'MMMM')) AS month_name, YEAR(Session5DateUtc) AS year, QUARTER(Session5DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL) z WHERE date_id is NOT NULL
event_dim|SELECT * FROM (SELECT DISTINCT MD5(CONCAT(CAST(RoundNumber AS STRING), LOWER(REPLACE(OfficialEventName, ' ', '')))) AS event_id,RoundNumber AS round_number,OfficialEventName AS official_event_name,EventName AS event_name,EventFormat AS event_type FROM {raw_table} WHERE RoundNumber>0) z WHERE event_id IS NOT NULL
location_dim|SELECT * FROM (SELECT DISTINCT md5(CONCAT(LOWER(REPLACE(Location, ' ', '')), LOWER(REPLACE(Country, ' ', '')))) AS location_id, Location AS location_name,Country AS country_name FROM {raw_table} WHERE RoundNumber>0) z WHERE location_id IS NOT NULL
session_dim|SELECT * FROM (SELECT DISTINCT MD5(CONCAT('1', LOWER(REPLACE(Session1, ' ', '')))) AS session_id, 1 AS session_number,Session1 AS session_type FROM {raw_table} WHERE RoundNumber>0 UNION SELECT DISTINCT MD5(CONCAT('2', LOWER(REPLACE(Session2, ' ', '')))) AS session_id, 2 AS session_number,Session2 AS session_type FROM {raw_table} WHERE RoundNumber>0 UNION SELECT DISTINCT MD5(CONCAT('3', LOWER(REPLACE(Session3, ' ', '')))) AS session_id, 3 AS session_number,Session3 AS session_type FROM {raw_table} WHERE RoundNumber>0 UNION SELECT DISTINCT MD5(CONCAT('4', LOWER(REPLACE(Session4, ' ', '')))) AS session_id, 4 AS session_number,Session4 AS session_type FROM {raw_table} WHERE RoundNumber>0 UNION SELECT DISTINCT MD5(CONCAT('5', LOWER(REPLACE(Session5, ' ', '')))) AS session_id, 5 AS session_number,Session5 AS session_type FROM {raw_table} WHERE RoundNumber>0) z WHERE session_id IS NOT NULL
schedule_fact|SELECT * FROM (SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session1DateUtc) AS BIGINT) AS schedule_id, md5(CONCAT(LOWER(REPLACE(Location, ' ', '')), LOWER(REPLACE(Country, ' ', '')))) AS location_id, MD5(CONCAT(CAST(RoundNumber AS STRING), LOWER(REPLACE(OfficialEventName, ' ', '')))) AS event_id, MD5(CONCAT('1', LOWER(REPLACE(Session1, ' ', '')))) AS session_id,CAST(UNIX_TIMESTAMP(Session1DateUtc) AS BIGINT) AS date_id FROM schedule_raw WHERE RoundNumber>0 UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session2DateUtc) AS BIGINT) AS schedule_id, md5(CONCAT(LOWER(REPLACE(Location, ' ', '')), LOWER(REPLACE(Country, ' ', '')))) AS location_id, MD5(CONCAT(CAST(RoundNumber AS STRING), LOWER(REPLACE(OfficialEventName, ' ', '')))) AS event_id, MD5(CONCAT('2', LOWER(REPLACE(Session2, ' ', '')))) AS session_id,CAST(UNIX_TIMESTAMP(Session2DateUtc) AS BIGINT) AS date_id FROM schedule_raw WHERE RoundNumber>0 UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session3DateUtc) AS BIGINT) AS schedule_id, md5(CONCAT(LOWER(REPLACE(Location, ' ', '')), LOWER(REPLACE(Country, ' ', '')))) AS location_id, MD5(CONCAT(CAST(RoundNumber AS STRING), LOWER(REPLACE(OfficialEventName, ' ', '')))) AS event_id, MD5(CONCAT('3', LOWER(REPLACE(Session3, ' ', '')))) AS session_id,CAST(UNIX_TIMESTAMP(Session3DateUtc) AS BIGINT) AS date_id FROM schedule_raw WHERE RoundNumber>0 UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session4DateUtc) AS BIGINT) AS schedule_id, md5(CONCAT(LOWER(REPLACE(Location, ' ', '')), LOWER(REPLACE(Country, ' ', '')))) AS location_id, MD5(CONCAT(CAST(RoundNumber AS STRING), LOWER(REPLACE(OfficialEventName, ' ', '')))) AS event_id, MD5(CONCAT('4', LOWER(REPLACE(Session4, ' ', '')))) AS session_id,CAST(UNIX_TIMESTAMP(Session4DateUtc) AS BIGINT) AS date_id FROM schedule_raw WHERE RoundNumber>0 UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session5DateUtc) AS BIGINT) AS schedule_id, md5(CONCAT(LOWER(REPLACE(Location, ' ', '')), LOWER(REPLACE(Country, ' ', '')))) AS location_id, MD5(CONCAT(CAST(RoundNumber AS STRING), LOWER(REPLACE(OfficialEventName, ' ', '')))) AS event_id, MD5(CONCAT('5', LOWER(REPLACE(Session5, ' ', '')))) AS session_id,CAST(UNIX_TIMESTAMP(Session5DateUtc) AS BIGINT) AS date_id FROM schedule_raw WHERE RoundNumber>0) z WHERE schedule_id IS NOT NULL
