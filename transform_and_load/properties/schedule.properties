date_dim|SELECT * FROM (SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session1DateUtc) AS BIGINT) AS date_id, Session1DateUtc AS full_timestamp, Session1Date AS local_timestamp, TRIM(DATE_FORMAT(Session1DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session1DateUtc, 'MMMM')) AS month_name, YEAR(Session1DateUtc) AS year, QUARTER(Session1DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL  UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session2DateUtc) AS BIGINT) AS date_id, Session2DateUtc AS full_timestamp, Session2Date AS local_timestamp, TRIM(DATE_FORMAT(Session2DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session2DateUtc, 'MMMM')) AS month_name, YEAR(Session2DateUtc) AS year, QUARTER(Session2DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL  UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session3DateUtc) AS BIGINT) AS date_id, Session3DateUtc AS full_timestamp, Session3Date AS local_timestamp, TRIM(DATE_FORMAT(Session3DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session3DateUtc, 'MMMM')) AS month_name, YEAR(Session3DateUtc) AS year, QUARTER(Session3DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL  UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session4DateUtc) AS BIGINT) AS date_id, Session4DateUtc AS full_timestamp, Session4Date AS local_timestamp, TRIM(DATE_FORMAT(Session4DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session4DateUtc, 'MMMM')) AS month_name, YEAR(Session4DateUtc) AS year, QUARTER(Session4DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL  UNION SELECT DISTINCT CAST(UNIX_TIMESTAMP(Session5DateUtc) AS BIGINT) AS date_id, Session5DateUtc AS full_timestamp, Session5Date AS local_timestamp, TRIM(DATE_FORMAT(Session5DateUtc, 'EEEE')) AS day_of_week, TRIM(DATE_FORMAT(Session5DateUtc, 'MMMM')) AS month_name, YEAR(Session5DateUtc) AS year, QUARTER(Session5DateUtc) AS quarter FROM {raw_table} WHERE RoundNumber>0 AND RoundNumber IS NOT NULL) z WHERE date_id is NOT NULL
